# 7장. SQL 응용
## 1. 데이터베이스 기본
### 1. 트랜젝션
### 2. DDL
1. 개념
	- Data Definition Language
	- 데이터 정의어: 데이터 구조와 관련
2. DDL의 대상
	- 도메인
	- 스키마
		- 외부
		- 개념
		- 내부
	- 테이블(Table) = 릴레이션(Relation) = 엔티티(Entity)
		- 필드들로 구성된 데이터의 집합체
		- 튜플(Tuple) = 행(Row) = 레코드, 릴레이션에서 같은 값을 가질 수 없음, 튜플의 수 = 카디널리티(cardinality)
		- 애트리뷰트(Attribute) = 열(Column), 열의 수 = 차수(degree)
		- 식별자
		- 도메인 = 단일 애트리뷰트가 취할 수 있는 같은 타입의 원자값들의 집합
	- 뷰
		- 물리테이블들로부터 join 등으로 생성된 논리 테이블
		- 단순 질의어 사용 가능: 여러 테이블 접근할 필요 없이 사용 간단, 테이블의 일부만 이용
		- 특징
			- 논리적 데이터 독립성: DB에 영향 없이 원하는 형태로 데이터 접근
			- 데이터 조작 연산 간소화
			- 보안 기능(접근제어) 제공: 뷰 외의 필드 조회, 접근을 불가하게
			- 뷰 변경 불가:  뷰 정의는 alter문으로 변경 불가(뷰는 create ~ drop)
		- 장단점
			- 장점
				- 논리적 독립성
				- 데이터 관리 용이
				- 데이터 보안 용이
			- 단점
				- 뷰 자체 인덱스 불가
				- 뷰 정의 변경 불가
				- 데이터 변경 제약 존재
	- 인덱스
		- 테이블에 대한 조회속도를 높이는 자료구조
		- 테이블의 특정 레코드(=튜플) 위치를 알려 주는 용도
		- 특징
			- 기본키(PK; Primary Key) 컬럼은 자동으로 인덱스가 생성
			- 연원일, 이름 기준 인덱스는 자동 생성 안함
			- 조건절에 '='로 비교되는 컬럼을 대상으로 인덱스 설정시 검색 속도 향상
			- 인덱스 유무에 따른 검색
				- 없을 경우: 테이블 전체 스캔(Table Full Scan): 테이블 전체 검색
				- 있을 경우: 인덱스 범위 스캔(Index Range Scan): 빠른 검색
			- 종류
				- 순서 인덱스(Ordered): 정렬된 순서로 생성된 인덱스, B-Tree 알고리즘 활용
				- 해시 인덱스(Hash): 해시함수 이용하여 데이터 키 값으로 직접 접근, 튜플(Row) 양에 무관한 데이터 접근 비용
				- 비트맵 인덱스(Bitmap): 각 컬럼에 적은 개수 값이 입력된 경우, 수정 변경이 적은 경우 이용(생년월일, 상품번호 등)
				- 함수 기반 인덱스(Functional): 수식이나 함수를 적용함
				- 단일 인덱스(Singled): 단일 컬럼으로만 구성, 주 사용 컬럼이 하나이 경우 사용
				- 결합 인덱스(Concatenated): 두 개 이상의 컬럼으로 구성, WHERE 조건 사용 빈도가 높은 경우 사용
				- 클러스터드 인덱스(Clustered): PK기준으로 레코드를 묶어 저장하는 인덱스, 저장 데이터의 물리적 순서에 따라 인덱스 생성, 특정 범위 검색에 유리
			- 스캔 방식
				- 인덱스 범위 스캔(Index Range Scan): 루트 블록 -> 리프 블록 탐색 후 리프 블록을 필요 범위만큼 스캔
				- 인덱스 전체 스캔(Index Full Scan): 수직 탐색 없이 인덱스 리프 블록을 처음부터 끝까지 수평적으로 탐색
				- 인덱스 단일 스캔(Index Unique Scan): 수직적 탐색만
				- 인덱스 생략 스캔(Index Skip Scan): 선두 컬럼이 조건 절에 빠졌어도 인덱스를 활용하는 스캔 방식
3. DDL 명령어
	- CREATE: DB 오브젝트 생성
	- ALTER: ~ 변경
	- DROP: ~ 삭제
	- TRUNCATE: ~ 내용 삭제
4. TABLE관련 DDL
	1. CREATE TABLE: 테이블 생성
		```SQL
		CREATE TABLE 사원
		(
		  사번 VARCHAR(10) PRIMARY KEY,
		  업무 VARCHAR(20) FOREIGN KEY REFERENCES 부서(부서코드),
		  이름 VARCHAR(10) UNIQUE,
		  생년월일 CHAR(8) NOT NULL,
		  성별 CHAR(1) CHECK (성별 = 'M' OR 성별 = 'F'),
		  입사일 DATE DEFAULT SYSDATE -- SYSDATE는 현재시간/날짜
		);

	2. ALTER TABLE: 테이블 수정
		- 컬럼 추가: CREATE TABLE의 제약조건 사용 가능
			```SQL
			ALTER TABLE 사원 ADD 전화번호 VARCHAR(11) UNIQUE;
		- 컬럼 수정
			```SQL
			ALTER TABLE 사원 MODIFY 이름 VARCHAR(30) NOT NULL;
		- 컬럼 삭제
			```SQL
			ALTER TABLE 사원 DROP 생년월일;
	3. DROP TABLE: 테이블 삭제
		- FK의 경우 옵션으로 CASCADE(참조하는 테이블 연쇄 삭제)와 RESTRICT(삭제할 테이블이 참조되고 있으면 제거 안 함) 중 선택 가능
		```SQL
		DROP TABLE 사원;
	4. TRUNCATE TABLE: 테이블 내 데이터 삭제
		```SQL
		TRUNCATE TABLE 사원;
5. VIEW 관련 DDL
	1. CREATE VIEW: 뷰 생성
		- VIEW 테이블의 SELECT 문에는 UNION이나 ORDER BY 절 사용 불가
		- 컬럼명 생략시 SELECT문의 컬럼명이 자동 사용
		```SQL
		CREATE VIEW 사원뷰 AS
		SELECT 사번, 이름
		   FROM 사원
		   WHERE 성별 = 'M';
	2. CREATE OR REPLACE VIEW
		- 뷰를 교체, 사용법은 CREATE VIEW와 동일
	3. DROP VIEW
		```SQL
		DROP VIEW 뷰이름;
6. INDEX 관련 DDL
	1. CREATE INDEX: 인덱스 생성
		- UNIQUE 생략 가능, 인덱스가 걸린 컬럼은 중복 허용 X
		- 복수 컬럼을 인덱스로 걸 수 있음
			```SQL
			CREATE INDEX 사번인덱스 ON 사원(사번);
	2. ALTER INDEX: 인덱스 수정
		- 일부 DBMS에서 지원하지 않음
		- 기존 인덱스 삭제 + 신규 인덱스 생성을 권장
		```SQL
		ALTER INDEX 사번인덱스 ON 사원(사번);
	3. DROP INDEX: 인덱스 삭제
		```SQL
		DROP INDEX 사번인덱스;
### 3. DML
1. 개념
	- 데이터 조작어 DML; Data Manipulation Language
	- 데이터베이스에 저장된 자료들을 CRUD 하는 언어
2. DML 명령어: SELECT, INSERT, UPDATE, DELETE
3. SELECT(데이터 조회) 명령어
